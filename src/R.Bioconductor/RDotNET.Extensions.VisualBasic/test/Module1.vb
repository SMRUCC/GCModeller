#Region "Microsoft.VisualBasic::653b986f8773dd1aa9a4e14e75f33701, RDotNET.Extensions.VisualBasic\test\Module1.vb"

    ' Author:
    ' 
    '       asuka (amethyst.asuka@gcmodeller.org)
    '       xie (genetics@smrucc.org)
    '       xieguigang (xie.guigang@live.com)
    ' 
    ' Copyright (c) 2018 GPL3 Licensed
    ' 
    ' 
    ' GNU GENERAL PUBLIC LICENSE (GPL3)
    ' 
    ' 
    ' This program is free software: you can redistribute it and/or modify
    ' it under the terms of the GNU General Public License as published by
    ' the Free Software Foundation, either version 3 of the License, or
    ' (at your option) any later version.
    ' 
    ' This program is distributed in the hope that it will be useful,
    ' but WITHOUT ANY WARRANTY; without even the implied warranty of
    ' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    ' GNU General Public License for more details.
    ' 
    ' You should have received a copy of the GNU General Public License
    ' along with this program. If not, see <http://www.gnu.org/licenses/>.



    ' /********************************************************************************/

    ' Summaries:

    ' Module Module1
    ' 
    '     Sub: interpreterStackSizeTest, Main
    ' 
    ' /********************************************************************************/

#End Region

Imports RDotNet.Extensions.VisualBasic.API
Imports RDotNet.Extensions.VisualBasic

Public Module Module1

    Sub interpreterStackSizeTest()

        ' tmp02hkp <- c(94.75, 94.83, 94.92, 95, 98.92, 104.83, 104.92, 
        Dim script = "E:\GCModeller\src\R.Bioconductor\RDotNET.Extensions.VisualBasic\test\stackTest.R"

        SyncLock R
            With R

                Call base.source(script)

                Dim v As var = base.c(
                    94.75, 94.83, 94.92, 95, 98.92, 104.83, 104.92, 106.92, 107, 107.08, 108.67, 108.83, 108.92, 109, 109.08, 109.17,
                    110.75, 112.17, 114.75, 114.83, 114.92, 115, 116.83, 116.92, 117, 118.67, 118.75, 118.92, 119, 119.83, 120.75,
                    120.83, 120.92, 121, 121.08, 121.17, 121.83, 122.17, 122.75, 122.83, 122.92, 123, 123.75, 124.92, 126.67, 126.75,
                    126.83, 126.92, 128.67, 128.75, 128.83, 128.92, 129.5, 129.58, 129.67, 131.08, 132.67, 132.75, 132.83, 132.92, 133,
                    133.08, 133.17, 134.58, 134.67, 134.75, 134.83, 134.92, 135, 135.08, 135.17, 135.25, 135.83, 135.92, 136, 138, 138.08,
                    138.83, 138.92, 139, 140.75, 140.83, 140.92, 141, 141.17, 142.5, 142.58, 142.67, 142.75, 142.83, 142.92, 143, 143.08,
                    143.17, 143.92, 144, 144.08, 144.17, 144.25, 144.33, 144.42, 144.75, 144.83, 144.92, 145, 145.08, 145.17, 145.92,
                    146, 146.08, 146.67, 146.75, 146.83, 146.92, 147, 147.08, 148.75, 148.83, 148.92, 149, 149.08, 149.17, 149.25, 150.58,
                    150.67, 150.75, 150.83, 150.92, 151, 151.83, 151.92, 152, 152.67, 152.75, 152.83, 152.92, 153, 153.08, 153.17, 153.25,
                    153.33, 153.42, 153.75, 153.83, 153.92, 154.08, 154.58, 154.67, 154.75, 154.83, 154.92, 155, 155.08, 155.67, 156, 156.58,
                    156.67, 156.75, 156.83, 156.92, 157, 157.08, 157.17, 157.75, 157.83, 157.92, 158.5, 158.58, 158.67, 158.75, 158.83,
                    158.92, 159, 159.08, 159.67, 159.75, 159.83, 159.92, 160, 160.08, 160.17, 160.67, 160.75, 160.83, 160.92, 161, 161.08,
                    161.17, 161.67, 161.83, 161.92, 162, 162.08, 162.17, 162.25, 162.33, 162.67, 162.75, 162.83, 162.92, 163, 163.08, 163.17,
                    163.58, 163.67, 163.92, 164, 164.08, 164.67, 164.75, 164.83, 164.92, 165, 165.08, 165.92, 166, 166.58, 166.67, 166.75, 166.83,
                    166.92, 167, 167.08, 167.17, 167.67, 167.75, 167.83, 167.92, 168, 168.08, 168.17, 168.25, 168.58, 168.67, 168.75, 168.83,
                    168.92, 169, 169.08, 169.17, 169.25, 169.33, 169.67, 169.75, 169.83, 169.92, 170, 170.33, 170.58, 170.67, 170.75, 170.83,
                    170.92, 171, 171.08, 171.17, 171.67, 171.75, 171.83, 171.92, 172, 172.08, 172.17, 172.25, 172.33, 172.42, 172.58, 172.67,
                    172.75, 172.83, 172.92, 173, 173.08, 173.17, 173.25, 173.75, 173.83, 174, 174.08, 174.17, 174.25, 174.33, 174.42, 174.5, 174.58,
                    174.67, 174.75, 174.83, 174.92, 175, 175.08, 175.17, 175.25, 175.33, 175.75, 175.83, 175.92, 176, 176.08, 176.5, 176.58, 176.67,
                    176.75, 176.83, 176.92, 177, 177.08, 177.17, 177.25, 177.33, 177.92, 178.58, 178.67, 178.75, 178.83, 178.92, 179, 179.08, 179.17,
                    179.92, 180.58, 180.67, 180.75, 180.83, 180.92, 181, 181.08, 181.17, 181.5, 181.58, 181.67, 181.75, 181.83, 181.92, 182, 182.08,
                    182.17, 182.5, 182.58, 182.67, 182.75, 182.83, 182.92, 183, 183.08, 183.17, 183.25, 183.33, 183.42, 183.5, 183.58, 183.67, 183.75,
                    183.83, 183.92, 184, 184.08, 184.17, 184.25, 184.33, 184.42, 184.5, 184.58, 184.67, 184.75, 184.83, 184.92, 185, 185.08, 185.17,
                    185.25, 185.5, 185.58, 185.67, 185.75, 185.83, 185.92, 186, 186.08, 186.17, 186.25, 186.33, 186.42, 186.5, 186.58, 186.67, 186.75,
                    186.83, 186.92, 187, 187.08, 187.17, 187.25, 187.33, 187.67, 187.75, 188.08, 188.17, 188.58, 188.67, 188.75, 188.83, 188.92, 189,
                    189.08, 189.17, 190.75, 190.83, 190.92, 191, 191.08, 191.17, 191.5, 191.58, 191.67, 191.75, 191.83, 191.92, 192, 192.08, 192.17,
                    192.25, 192.5, 192.58, 192.67, 192.75, 192.83, 192.92, 193, 193.08, 193.17, 193.25, 193.42, 193.75, 193.83, 193.92, 194, 194.08,
                    194.17, 194.58, 194.67, 194.75, 194.83, 194.92, 195, 195.08, 195.17, 195.25, 196, 196.08, 196.17, 196.42, 196.5, 196.58, 196.67,
                    196.75, 196.83, 196.92, 197, 197.08, 197.17, 197.25, 197.33, 197.58, 197.67, 197.75, 197.83, 197.92, 198, 198.08, 198.17, 198.25,
                    198.33, 198.58, 198.67, 198.75, 198.83, 198.92, 199, 199.08, 199.17, 199.25, 199.75, 199.83, 199.92, 200, 200.08, 200.17, 200.5,
                    200.58, 200.67, 200.75, 200.83, 200.92, 201, 201.08, 201.17, 201.25, 201.83, 201.92, 202, 202.08, 202.17, 202.25, 202.33, 202.42,
                    202.5, 202.58, 202.67, 202.75, 202.83, 202.92, 203, 203.08, 203.17, 203.25, 203.58, 203.67, 203.75, 203.83, 204, 204.08, 204.33,
                    204.42, 204.75, 204.83, 204.92, 205, 205.08, 206, 206.08, 206.17, 206.58, 206.67, 206.75, 206.83, 206.92, 207, 207.08, 207.17,
                    207.25, 207.33, 207.92, 208, 208.08, 208.17, 208.25, 208.5, 208.58, 208.67, 208.75, 208.83, 208.92, 209, 209.08, 209.17, 209.25,
                    209.83, 209.92, 210, 210.08, 210.17, 210.25, 210.58, 210.67, 210.75, 210.83, 210.92, 211, 211.08, 211.17, 211.25, 211.33, 211.42,
                    211.58, 211.67, 211.83, 211.92, 212, 212.08, 212.17, 212.25, 212.5, 212.58, 212.67, 212.75, 212.83, 212.92, 213, 213.08, 213.17,
                    213.25, 213.33, 213.42, 213.5, 213.58, 213.67, 213.75, 213.83, 213.92, 214, 214.08, 214.17, 214.25, 214.33, 214.42, 214.5, 214.58,
                    214.67, 214.75, 214.83, 214.92, 215, 215.08, 215.17, 215.25, 215.33, 215.42, 215.75, 215.83, 215.92, 216, 216.08, 216.17, 216.5,
                    216.58, 216.67, 216.75, 216.83, 216.92, 217, 217.08, 217.17, 217.92, 218, 218.08, 218.83, 218.92, 219, 219.08, 219.17, 219.75,
                    219.83, 219.92, 220, 220.08, 220.17, 220.25, 220.33, 220.75, 220.83, 220.92, 221, 221.08, 221.17, 221.92, 222, 222.08, 222.67,
                    222.75, 222.83, 222.92, 223, 223.08, 223.17, 223.25, 223.33, 223.83, 223.92, 224, 224.08, 224.17, 224.25, 224.42, 224.5, 224.58,
                    224.67, 224.75, 224.83, 224.92, 225, 225.08, 225.17, 225.25, 225.33, 225.42, 225.75, 225.83, 225.92, 226, 226.08, 226.17, 226.25,
                    226.33, 226.5, 226.58, 226.67, 226.75, 226.83, 226.92, 227, 227.08, 227.17, 227.25, 227.33, 227.58, 227.67, 227.75, 227.83, 227.92,
                    228, 228.08, 228.17, 228.25, 228.58, 228.67, 228.75, 228.83, 228.92, 229, 229.08, 229.17, 229.25, 229.33, 229.83, 229.92, 230.08,
                    230.17, 230.42, 230.5, 230.58, 230.67, 230.75, 230.83, 230.92, 231, 231.08, 231.17, 231.25, 231.33, 231.42, 231.5, 231.83, 231.92,
                    232, 232.42, 232.5, 232.58, 232.67, 232.75, 232.83, 232.92, 233, 233.08, 233.17, 233.25, 233.33, 233.42, 233.5, 233.75, 233.83, 233.92,
                    234, 234.08, 234.17, 234.25, 234.5, 234.58, 234.67, 234.75, 234.83, 234.92, 235, 235.08, 235.17, 235.25, 235.33, 235.42, 235.5,
                    235.58, 235.67, 235.75, 235.83, 235.92, 236, 236.08, 236.17, 236.5, 236.58, 236.67, 236.75, 236.83, 236.92, 237, 237.08, 237.17, 237.25,
                    237.33, 237.42, 237.5, 237.75, 237.83, 237.92, 238, 238.08, 238.17, 238.25, 238.33, 238.58, 238.67, 238.75, 238.83, 238.92, 239, 239.08, 239.17, 239.25, 239.33, 240.67, 240.75, 240.83, 240.92, 241, 241.08, 241.17, 241.25, 241.33, 241.42, 241.67, 241.75, 241.83, 241.92, 242, 242.08, 242.42, 242.5, 242.58, 242.67, 242.75, 242.83, 242.92, 243, 243.08, 243.17, 243.25, 243.33, 243.42, 243.5, 243.58, 243.83, 243.92, 244, 244.08, 244.17, 244.58, 244.67, 244.75, 244.83, 244.92, 245, 245.08, 245.17, 245.25, 245.33, 245.67, 245.92, 246, 246.42, 246.5, 246.58, 246.67, 246.75, 246.83, 246.92, 247, 247.08, 247.17, 247.25, 247.33, 247.58, 247.67, 247.75, 247.83, 247.92, 248, 248.08, 248.17, 248.25, 248.33, 248.42, 248.5, 248.58, 248.67, 248.75, 248.83, 248.92, 249, 249.08, 249.17, 249.25, 249.33, 249.42, 249.5, 249.58, 249.67, 249.75, 249.83, 249.92, 250, 250.08, 250.17, 250.25, 250.33, 250.42, 250.5, 250.58, 250.67, 250.75, 250.83, 250.92, 251, 251.08, 251.17, 251.25, 251.33, 251.5, 251.58, 251.67, 251.75, 251.83, 251.92, 252, 252.08, 252.17, 252.25, 252.33, 252.42, 252.5, 252.58, 252.67, 252.75, 252.83, 252.92, 253, 253.08, 253.17, 253.25, 253.33, 253.42, 253.5, 253.58, 253.92, 254, 254.08, 254.17, 254.25, 254.58, 254.67, 254.75, 254.83, 254.92, 255, 255.08, 255.17, 255.25, 255.33, 255.42, 255.5, 255.58, 255.67, 255.75, 255.83, 255.92, 256, 256.08, 256.17, 256.25, 256.33, 256.5, 256.58, 256.67, 256.75, 256.83, 256.92, 257, 257.08, 257.17, 257.25, 257.33, 257.42, 257.5, 257.58, 257.67, 257.75, 257.83, 257.92, 258, 258.08, 258.17, 258.33, 258.42, 258.5, 258.58, 258.67, 258.75, 258.83, 258.92, 259, 259.08, 259.17, 259.25, 259.42, 260.58, 260.75, 260.83, 260.92, 261, 261.08, 261.17, 261.92, 262, 262.08, 262.5, 262.58, 262.67, 262.75, 262.83, 262.92, 263, 263.08, 263.17, 263.25, 263.33, 263.42, 263.58, 263.67, 263.75, 263.83, 263.92, 264, 264.08, 264.17, 264.25, 264.33, 264.42, 264.5, 264.58, 264.67, 264.75, 264.83, 264.92, 265, 265.08, 265.17, 265.25, 265.33, 265.42, 265.5, 265.58, 265.67, 265.75, 265.83, 265.92, 266, 266.08, 266.17, 266.25, 266.33, 266.42, 266.5, 266.58, 266.67, 266.75, 266.83, 266.92, 267, 267.08, 267.17, 267.25, 267.33, 267.42, 267.5, 267.58, 267.67, 267.75, 267.83, 267.92, 268, 268.08, 268.17, 268.25, 268.33, 268.42, 268.5, 268.58, 268.67, 268.75, 268.83, 268.92, 269, 269.08, 269.17, 269.25, 269.33, 269.42, 269.5, 269.58, 269.67, 269.75, 269.92, 270, 270.08, 270.17, 270.25, 270.33, 270.42, 270.5, 270.58, 270.67, 270.75, 270.83, 270.92, 271, 271.08, 271.17, 271.25, 271.33, 271.42, 271.5, 271.58, 271.67, 271.75, 271.83, 271.92, 272, 272.08, 272.17, 272.25, 272.42, 272.5, 272.67, 272.75, 272.83, 272.92, 273, 273.08, 273.17, 273.25, 273.33, 274, 274.08, 275, 275.08, 275.17, 275.25, 275.33, 275.42, 275.5, 275.58, 275.67, 275.75, 276, 276.08, 276.17, 276.25, 276.58, 276.67, 276.75, 276.83, 276.92, 277, 277.08, 277.17, 277.25, 277.33, 277.42, 277.83, 277.92, 278, 278.08, 278.17, 278.25, 278.33, 278.42, 278.58, 278.67, 278.75, 278.83, 278.92, 279, 279.08, 279.17, 279.25, 279.33, 279.42, 279.5, 279.58, 279.67, 279.75, 279.83, 279.92, 280, 280.08, 280.17, 280.25, 280.33, 280.42, 280.5, 280.58, 280.67, 280.75, 280.83, 280.92, 281, 281.08, 281.17, 281.25, 281.33, 281.42, 281.5, 281.58, 281.67, 281.75, 281.83, 281.92, 282, 282.08, 282.17, 282.25, 282.33, 282.42, 282.5, 282.58, 282.67, 282.75, 282.83, 282.92, 283, 283.08, 283.17, 283.25, 283.33, 283.42, 283.5, 283.58, 283.67, 283.75, 283.83, 283.92, 284, 284.08, 284.17, 284.25, 284.33, 284.42, 284.5, 284.58, 284.67, 284.75, 284.83, 284.92, 285, 285.08, 285.17, 285.25, 285.33, 285.42, 285.5, 285.58, 285.83, 285.92, 286, 286.08, 286.17, 286.67, 286.75, 286.83, 286.92, 287, 287.08, 287.17, 287.25, 287.33, 287.42, 287.5, 287.58, 287.67, 287.75, 287.83, 287.92, 288, 288.08, 288.17, 288.25, 288.33, 288.42, 288.5, 288.58, 288.67, 288.75, 288.83, 288.92, 289, 289.08, 289.17, 289.25, 289.33, 289.42, 289.5, 289.58, 290.08, 290.17, 290.25, 290.33, 290.42, 290.67, 290.75, 290.83, 290.92, 291, 291.08, 291.17, 291.25, 291.33, 291.42, 291.58, 291.67, 291.83, 291.92, 292, 292.08, 292.17, 292.25, 292.33, 292.42, 292.58, 292.67, 292.75, 292.83, 292.92, 293, 293.08, 293.17, 293.25, 293.33, 293.75, 293.83, 293.92, 294, 294.08, 294.17, 294.25, 294.33, 294.42, 294.5, 294.58, 294.67, 294.75, 294.83, 294.92, 295, 295.08, 295.17, 295.25, 295.33, 295.42, 295.5, 295.58, 295.67, 295.75, 295.83, 295.92, 296, 296.08, 296.17, 296.25, 296.33, 296.42, 296.5, 296.58, 296.67, 296.75, 296.83, 296.92, 297, 297.08, 297.17, 297.25, 297.33, 297.42, 297.5, 297.58, 297.67, 297.75, 297.83, 297.92, 298, 298.08, 298.17, 298.25, 298.33, 298.42, 298.5, 298.58, 298.67, 298.75, 298.83, 298.92, 299, 299.08, 299.17, 299.25, 299.33, 299.42, 299.5, 299.58, 299.67, 299.75, 299.83, 299.92, 300, 300.08, 300.17, 300.25, 300.33, 300.42, 300.5, 300.58, 300.67, 300.75, 300.92, 301, 301.08, 303.17, 303.58, 303.67, 303.75, 303.83, 304, 304.08, 304.33, 304.42, 304.5, 304.75, 304.83, 304.92, 305, 305.08, 305.17, 305.25, 305.33, 305.42, 305.5, 305.58, 305.67, 305.75, 305.92, 306, 306.08, 306.17, 306.25, 306.33, 306.42, 306.5, 306.58, 306.67, 306.75, 306.83, 306.92, 307, 307.08, 307.17, 307.25, 307.33, 307.42, 308, 308.08, 308.17, 308.25, 308.33, 308.42, 308.5, 308.58, 308.67, 308.75, 308.83, 308.92, 309, 309.08, 309.17, 309.25, 309.33, 309.42, 309.5, 309.58, 309.67, 309.75, 309.83, 309.92, 310, 310.08, 310.17, 310.25, 310.33, 310.42, 310.5, 310.58, 310.67, 310.75, 310.83, 310.92, 311, 311.08, 311.17, 311.25, 311.33, 311.42, 311.5, 311.58, 311.67, 311.75, 311.83, 311.92, 312, 312.08, 312.17, 312.25, 312.33, 312.42, 312.5, 312.58, 312.67, 312.75, 312.83, 312.92, 313, 313.08, 313.17, 313.25, 313.33, 313.42, 313.5, 313.58, 313.67, 313.75, 313.83, 313.92, 314.17, 314.25, 314.33, 314.42, 314.58, 314.67, 314.75, 314.83, 314.92, 315, 315.08, 315.17, 315.75, 315.83, 316.17, 316.42, 316.75, 316.92, 317, 317.08, 317.17, 317.25, 317.33, 317.42, 317.5, 317.58, 317.67, 317.75, 317.83, 317.92, 318, 318.08, 318.17, 318.25, 318.33, 318.42, 318.5, 318.58, 318.67, 318.75, 318.83, 319.67, 320, 320.58, 320.67, 320.75, 320.92, 321, 321.08, 321.17, 321.25, 322.08, 322.42, 322.5, 322.75, 322.83, 322.92, 323, 323.08, 323.17, 323.25, 323.33, 323.42, 324.58, 324.83, 324.92, 325, 325.08, 325.17, 325.25, 326, 326.08, 326.17, 326.25, 326.33, 326.42, 326.5, 326.58, 326.67, 326.75, 326.83, 326.92, 327, 327.08, 327.17, 327.25, 327.33, 327.42, 327.5, 327.83, 329.33, 329.42, 329.67, 329.75, 329.83, 332.75, 332.83, 335.92, 336.33, 338.92, 339, 339.17, 339.25, 339.33)

                Call base.print(v)

                ' 测试结果是否一致
                Dim sum As var = base.sum($"tmp02hkp == {v}")
                Dim len1 = base.length(v)
                Dim len2 = base.length("tmp02hkp")

                If len1 <> len2 Then
                    Throw New NotImplementedException
                End If

                If len1 = len2 AndAlso len1 = sum.As(Of Integer) Then
                    ' 测试成功
                    Throw New Exception("test success!!!")

                End If

            End With
        End SyncLock

        Pause()
    End Sub

    Sub Main()

        Call interpreterStackSizeTest()

        Dim type = GetType(Module1)

        test2("3333", 33)

        Pause()
    End Sub

    Public Declare Function test2 Lib "stat" Alias "invoke.test" (args$, int%) As Boolean

End Module
